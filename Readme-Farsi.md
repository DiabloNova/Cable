کِیبل (Cable)کِیبل یک ابزار پس از بهره‌برداری است که برای شناسایی و بهره‌برداری متمرکز بر لیست کنترل دسترسی اختیاری (DACL) در محیط اکتیو دایرکتوری استفاده می‌شود. این ابزار در درجه اول برای یادگیری بیشتر در مورد توسعه تهاجمی .NET در زمینه اکتیو دایرکتوری ایجاد شده است، در حالی که امید است دانش و درک فعلی من از امنیت تهاجمی متمرکز بر اکتیو دایرکتوری را گسترش دهد.طریقه استفاده _______       ___  ________  ________  ________
|\_______|\|_______|\|__|\|__|\|_______\/|_______|
\|_______|\|_______|\|__|\|__|\|_______|\ \_______\
  \ \_|\ \ \  \____\ \  \|\  \ \  \____\ / /_|\ \
  \ \_|/__ \ \   __/ \ \   __  \ \  \    /| \  \
  |\   __/| \ \  \|\  \ \  \|\  \ \  \___|/ \  \|\
  |\  ___ \| \   __  \| \   __  \ \   __  \| \  \
  \|____|\ \ \|____|\ \ \|____|\ \ \|____|\ \ \|__|
          \|_______|\|_______|\|_______|\|_______|

ابزار جعبه‌ابزار پس از بهره‌برداری .NET برای شناسایی و بهره‌برداری از اکتیو دایرکتوری

Cable.exe [ماژول]
ماژول‌ها:
        ldap [گزینه‌ها]            - شمارش LDAP
        dclist                    - لیست کنترل‌کننده‌های دامنه در دامنه فعلی
        rbcd [گزینه‌ها]            - نوشتن یا حذف ویژگی msDs-AllowedToActOnBehalfOfOtherIdentity
        dacl [گزینه‌ها]            - خواندن یا نوشتن ورودی‌های کنترل دسترسی (ACE) بر روی یک شیء
        trusts                    - شمارش روابط اعتماد دامنه و جنگل اکتیو دایرکتوری
        ca                        - شمارش هرگونه سرویس‌های صدور گواهینامه فعال اکتیو دایرکتوری (ADCS)
        templates                 - شمارش قالب‌های سرویس‌های صدور گواهینامه اکتیو دایرکتوری (ADCS)
        user [گزینه‌ها]            - انجام عملیات عمومی بر روی حساب‌های کاربری
        computer [گزینه‌ها]        - افزودن و حذف حساب‌های کامپیوتری از دامنه
        group [گزینه‌ها]           - شمارش عضویت گروه، افزودن و حذف کاربران از گروه‌ها

گزینه‌های ماژول
ldap:
        /users                    - شمارش اشیاء کاربری
        /computers                - شمارش اشیاء کامپیوتری
        /groups                   - شمارش اشیاء گروهی
        /spns                     - شمارش اشیائی که servicePrincipalName آن‌ها تنظیم شده است
        /asrep                    - شمارش حساب‌هایی که نیازی به پیش‌احراز هویت کربروس ندارند
        /admins                   - شمارش حساب‌هایی که adminCount آن‌ها روی 1 تنظیم شده است
        /constrained              - شمارش حساب‌هایی که msDs-AllowedToDelegateTo آن‌ها تنظیم شده است
        /unconstrained            - شمارش حساب‌هایی که پرچم TRUSTED_FOR_DELEGATION آن‌ها تنظیم شده است
        /rbcd                     - شمارش حساب‌هایی که msDs-AllowedToActOnBehalfOfOtherIdentity آن‌ها تنظیم شده است
        /query:<query>            - شمارش اشیاء با یک پرس و جوی سفارشی
        /filter:"<attr, attr>"    - شمارش اشیاء برای ویژگی‌های خاص

rbcd:
        /write                    - عملیات نوشتن msDs-AllowedToActOnBehalfOfOtherIdentity
        /delegate-to:<account>    - حساب هدف برای تفویض دسترسی به آن
        /delegate-from:<account>  - حساب کنترل‌شده برای تفویض از آن
        /flush:<account>          - عملیات پاک کردن msDs-AllowedToActOnBehalfOfOtherIdentity روی یک حساب

dacl:
        /find                     - یافتن ACEهای بالقوه آسیب‌پذیر
        /object:<object>          - شیء برای انجام عملیات DACL بر روی آن
        /read                     - عملیات خواندن ورودی‌های کنترل دسترسی (ACE)های شیء
        /write:<permission>       - نوشتن یک ACE بر روی شیء انتخاب شده، مجوزهای داخلی عبارتند از: GenericAll,GenericWrite,User-Force-Reset-Password,Self-Membership
        /guid:<guid>              - تعیین GUID سفارشی برای مجوز یا حق توسعه یافته برای نوشتن بر روی شیء، جایگزین "--write"
        /account:<account>        - نمایش دسترسی یک حساب به شیء هدف، یا تنظیم دسترسی به این حساب بر روی شیء هدف. مثال: CORP\jdoe

user:
        /setspn:<value>           - نوشتن در ویژگی servicePrincipalName یک شیء
        /removespn:<value>        - حذف یک مقدار مشخص از ویژگی servicePrincipalName
        /setasrep                 - عملیات تنظیم پرچم DONT_REQ_PREAUTH بر روی ویژگی userAccountControl یک شیء
        /removeasrep              - عملیات حذف پرچم DONT_REQ_PREAUTH بر روی ویژگی userAccountControl یک شیء
        /user:<account>           - تعیین حساب کاربری برای انجام عملیات بر روی آن
        /password:<password>      - تغییر رمز عبور یک حساب
        /getgroups                - عملیات شمارش عضویت‌های گروه فعلی یک کاربر

computer:
        /add                      - عملیات افزودن یک شیء حساب کامپیوتری
        /remove                   - عملیات حذف یک شیء حساب کامپیوتری
        /name:<name>              - نام کامپیوتر برای افزودن یا حذف
        /password:<passwd>        - رمز عبور حساب کامپیوتری

group:
        /group:<group>            - گروه مورد استفاده برای یک عملیات مشخص شده
        /add:<account>            - افزودن یک حساب مشخص شده به گروه انتخاب شده
        /remove:<account>         - حذف یک حساب مشخص شده از گروه انتخاب شده
        /getusers                 - عملیات شمارش کاربران فعلی در یک گروه
